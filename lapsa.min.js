class Lapsa{callbacks={};slideContainer=null;slides=[];currentSlide=-1;buildState=0;tableViewSlidesPerScreen=4;useShelf=!0;useShelfIndicator=!0;permanentShelf=!1;shelfIconPaths=["/icons/up-2.png","/icons/up-1.png","/icons/table.png","/icons/down-1.png","/icons/down-2.png","/icons/shelf-indicator.png"];transitionAnimationTime=150;transitionAnimationDistanceFactor=.015;tableViewAnimationTime=600;shelfAnimationTime=275;tableViewEasing="cubic-bezier(.25, 1.0, .5, 1.0)";slideAnimateInEasing="cubic-bezier(.4, 1.0, .7, 1.0)";slideAnimateOutEasing="cubic-bezier(.1, 0.0, .2, 0.0)";shelfAnimateInEasing="cubic-bezier(.4, 1.0, .7, 1.0)";shelfAnimateOutEasing="cubic-bezier(.4, 0.0, .4, 1.0)";windowHeightAnimationFrames=8;resizeOnTableView=!1;appendHTML="";_rootSelector=null;_bottomMarginElement=null;_shelfContainer=null;_slideShelf=null;_shelfMargin=15;_shelfIsOpen=!1;_shelfIsAnimating=!1;_shelfIndicatorContainer=null;_slideShelfIndicator=null;_transitionAnimationDistance=0;_startingSlide=0;_numBuilds=[];_currentlyAnimating=!1;_inTableView=!1;_boundFunctions=[null,null,null,null,null];_maxTouches=0;_currentlyTouchDevice=!1;_lastMousemoveEvent=0;_lastWindowHeight=window.innerHeight;_startWindowHeight=window.innerHeight;_windowHeightAnimationFrame=0;_windowHeightAnimationLastTimestamp=-1;_resizeAnimationBound=null;_missedResizeAnimation=!1;constructor(i){this.callbacks=i?.builds??{},this.transitionAnimationTime=i?.transitionAnimationTime??150,this.transitionAnimationDistanceFactor=i?.transitionAnimationDistanceFactor??.015,this.tableViewAnimationTime=i?.tableViewAnimationTime??600,this.shelfAnimationTime=i?.shelfAnimationTime??275,this.resizeOnTableView=i?.resizeOnTableView??!1,this.windowHeightAnimationFrames=i?.windowHeightAnimationFrames??8,this._startingSlide=i?.startingSlide??0,this.tableViewSlidesPerScreen=i?.tableViewSlidesPerScreen??4,this.useShelf=i?.useShelf??!0,this.useShelfIndicator=i?.useShelfIndicator??!0,this.permanentShelf=i?.permanentShelf??!1,this.shelfIconPaths=i?.shelfIconPaths??"/icons/","string"==typeof this.shelfIconPaths&&(this.shelfIconPaths.length>=1&&"/"!==this.shelfIconPaths[this.shelfIconPaths.length-1]&&(this.shelfIconPaths=`${this.shelfIconPaths}/`),this.shelfIconPaths=[`${this.shelfIconPaths}up-2.png`,`${this.shelfIconPaths}up-1.png`,`${this.shelfIconPaths}table.png`,`${this.shelfIconPaths}down-1.png`,`${this.shelfIconPaths}down-2.png`,`${this.shelfIconPaths}shelf-indicator.png`]),this.shelfIconPaths.length<5&&this.useShelf&&console.error("[Lapsa] Not enough shelf icons provided!"),this.shelfIconPaths.length<6&&this.useShelfIndicator&&console.error("[Lapsa] No shelf indicator icon provided!"),this.slideAnimateInEasing=i?.slideAnimateInEasing??"cubic-bezier(.4, 1.0, .7, 1.0)",this.slideAnimateOutEasing=i?.slideAnimateOutEasing??"cubic-bezier(.1, 0.0, .2, 0.0)",this.shelfAnimateInEasing=i?.shelfAnimateInEasing??"cubic-bezier(.4, 1.0, .7, 1.0)",this.shelfAnimateOutEasing=i?.shelfAnimateOutEasing??"cubic-bezier(.4, 0.0, .4, 1.0)",this.tableViewEasing=i?.tableViewEasing??"cubic-bezier(.25, 1.0, .5, 1.0)",this.appendHTML=i?.appendHTML??"",this._rootSelector=document.querySelector(":root"),this._resizeAnimationBound=this._resizeAnimation.bind(this),this.slideContainer=document.body.querySelector("#lapsa-slide-container"),this.slideContainer.classList.add("lapsa-hover"),this._bottomMarginElement=document.createElement("div"),this._bottomMarginElement.id="lapsa-bottom-margin",this.slideContainer.appendChild(this._bottomMarginElement),this.slides=document.body.querySelectorAll(".slide"),this._numBuilds=Array(this.slides.length),this.slides.forEach((i,t)=>{let e=document.createElement("div");e.classList.add("lapsa-slide-wrapper"),e.style.top=window.innerWidth/window.innerHeight>=152/89?`calc(${100*t+2.5} * var(--safe-vh))`:`calc(${100*t} * var(--safe-vh) + (100 * var(--safe-vh) - 55.625vw) / 2)`,this.slideContainer.insertBefore(e,i),e.appendChild(i),0!==i.children.length?i.lastElementChild.insertAdjacentHTML("afterend",this.appendHTML):i.innerHTML=this.appendHTML,i.addEventListener("click",()=>{this._inTableView&&this.closeTableView(t)});let s=i.querySelectorAll(".build, [data-build]"),n=0;s.forEach(i=>{let t=i.getAttribute("data-build");null===t?(i.setAttribute("data-build",n),n++):n=parseInt(t)+1,i.classList.remove("build")});let l=Object.keys(this.callbacks?.[i.id]??{}),a=0;l.forEach(i=>a=Math.max(a,parseInt(i)+1||0)),this._numBuilds[t]=Math.max(n,a)}),this._transitionAnimationDistance=window.innerWidth/window.innerHeight>=152/89?window.innerHeight*this.transitionAnimationDistanceFactor*159/82:window.innerWidth*this.transitionAnimationDistanceFactor,this._rootSelector.style.setProperty("--safe-vh",`${window.innerHeight/100}px`),this._shelfContainer=document.createElement("div"),this._shelfContainer.id="lapsa-slide-shelf-container",this._shelfContainer.innerHTML=`
			<div id="lapsa-slide-shelf" class="lapsa-hover" style="margin-left: ${this._shelfMargin}px; opacity: 0">
				<input type="image" id="lapsa-up-2-button" class="shelf-button" src="${this.shelfIconPaths[0]}">
				<input type="image" id="lapsa-up-1-button" class="shelf-button" src="${this.shelfIconPaths[1]}">
				<input type="image" id="lapsa-table-button" class="shelf-button" src="${this.shelfIconPaths[2]}">
				<input type="image" id="lapsa-down-1-button" class="shelf-button" src="${this.shelfIconPaths[3]}">
				<input type="image" id="lapsa-down-2-button" class="shelf-button" src="${this.shelfIconPaths[4]}">
			</div>
		`,document.body.appendChild(this._shelfContainer),this._shelfIndicatorContainer=document.createElement("div"),this._shelfIndicatorContainer.id="lapsa-slide-shelf-indicator-container",this.useShelfIndicator&&(this._shelfIndicatorContainer.innerHTML=`<img id="lapsa-slide-shelf-indicator" src="${this.shelfIconPaths[5]}"></img>`),document.body.appendChild(this._shelfIndicatorContainer),"scrollRestoration"in history&&(history.scrollRestoration="manual"),setTimeout(()=>window.scrollTo(0,0),10),setTimeout(()=>{this._slideShelf=document.querySelector("#lapsa-slide-shelf"),this.useShelfIndicator&&(this._slideShelfIndicator=document.querySelector("#lapsa-slide-shelf-indicator")),this.permanentShelf?(this._shelfContainer.classList.add("permanent-shelf"),this.showSlideShelf(this._slideShelf),this._shelfIsAnimating=!1,this._shelfIsOpen=!0,this._slideShelfIndicator.style.display="none"):this.hideSlideShelf(this._slideShelf,0),this._shelfContainer.addEventListener("mouseenter",()=>{this._shelfIsOpen||this.permanentShelf||!this.useShelf||this.showShelf()}),this._shelfContainer.addEventListener("mouseleave",()=>{this._shelfIsOpen&&!this.permanentShelf&&this.useShelf&&this.hideShelf()}),this._slideShelf.children[0].addEventListener("click",()=>{this._shelfIsOpen&&!this._shelfIsAnimating&&this.previousSlide(!0)}),this._slideShelf.children[1].addEventListener("click",()=>{this._shelfIsOpen&&!this._shelfIsAnimating&&this.previousSlide()}),this._slideShelf.children[2].addEventListener("click",()=>{this._shelfIsOpen&&!this._shelfIsAnimating&&(this._inTableView?this.closeTableView(this.currentSlide):this.openTableView())}),this._slideShelf.children[3].addEventListener("click",()=>{this._shelfIsOpen&&!this._shelfIsAnimating&&this.nextSlide()}),this._slideShelf.children[4].addEventListener("click",()=>{this._shelfIsOpen&&!this._shelfIsAnimating&&this.nextSlide(!0)})},100),document.documentElement.style.overflowY="hidden",document.body.style.overflowY="hidden",document.body.style.userSelect="none",document.body.style.WebkitUserSelect="none",this._boundFunctions[0]=this._handleKeydownEvent.bind(this),this._boundFunctions[1]=this._handleTouchstartEvent.bind(this),this._boundFunctions[2]=this._handleTouchendEvent.bind(this),this._boundFunctions[3]=this._handleMousemoveEvent.bind(this),this._boundFunctions[4]=this._onResize.bind(this),document.documentElement.addEventListener("keydown",this._boundFunctions[0]),document.documentElement.addEventListener("touchstart",this._boundFunctions[1]),document.documentElement.addEventListener("touchend",this._boundFunctions[2]),document.documentElement.addEventListener("mousemove",this._boundFunctions[3]),window.addEventListener("resize",this._boundFunctions[4]),setTimeout(()=>this.jumpToSlide(this._startingSlide),500)}exit(){this.slideContainer.remove(),this.slides.forEach(i=>i.remove()),document.documentElement.style.overflowY="visible",document.body.style.overflowY="visible",document.body.style.height="fit-content",document.body.style.userSelect="auto",document.body.style.WebkitUserSelect="auto",document.documentElement.removeEventListener("keydown",this._boundFunctions[0]),document.documentElement.removeEventListener("touchstart",this._boundFunctions[1]),document.documentElement.removeEventListener("touchend",this._boundFunctions[2]),document.documentElement.removeEventListener("mousemove",this._boundFunctions[3]),window.removeEventListener("resize",this._boundFunctions[4])}_onResize(){if(!this._currentlyAnimating){if(this._transitionAnimationDistance=window.innerWidth/window.innerHeight>=152/89?window.innerHeight*this.transitionAnimationDistanceFactor*159/82:window.innerWidth*this.transitionAnimationDistanceFactor,this._inTableView){let i=document.body.getBoundingClientRect(),t=i.width/i.height>=152/89?1:i.height/(89*i.width/152),e=Math.min(t/this.tableViewSlidesPerScreen,1),s=t/e,n=Math.min(Math.max((s-1)/2,this.currentSlide),this.slides.length-1-(s-1)/2),l=i.width/i.height>=152/89?`calc(${(8835/89*n-100*n)*e} * var(--safe-vh))`:`calc(${58.125*n*e}vw - ${100*n*e} * var(--safe-vh))`;this.slides.forEach((i,t)=>{window.innerWidth/window.innerHeight>=152/89?i.parentNode.style.top=`calc(${5+8835/89*(t-n)+100*n} * var(--safe-vh))`:i.parentNode.style.top=`calc(${2.5+58.125*(t-n)}vw + ${100*n} * var(--safe-vh))`}),window.innerWidth/window.innerHeight>=152/89?this._bottomMarginElement.style.top=`calc(${5+8835/89*(this.slides.length-n)+100*n} * var(--safe-vh))`:this._bottomMarginElement.style.top=`calc(${2.5+58.125*(this.slides.length-n)}vw + ${100*n} * var(--safe-vh))`,this.slideContainer.style.transform=`translateY(${l}) scale(${e})`,this.resizeOnTableView?(this._startWindowHeight=this._lastWindowHeight,this._windowHeightAnimationFrame=1,window.requestAnimationFrame(this._resizeAnimationBound)):this._missedResizeAnimation=!0}else this._rootSelector.style.setProperty("--safe-vh",`${window.innerHeight/100}px`),this.slides.forEach((i,t)=>i.parentNode.style.top=window.innerWidth/window.innerHeight>=152/89?`calc(${100*t+2.5} * var(--safe-vh))`:`calc(${100*t} * var(--safe-vh) + (100 * var(--safe-vh) - 55.625vw) / 2)`),this.slideContainer.style.transform=`translateY(calc(${-100*this.currentSlide} * var(--safe-vh))) scale(1)`}}_resizeAnimation(i){let t=i=this._windowHeightAnimationLastTimestamp;if(this._windowHeightAnimationLastTimestamp=i,0===t)return;let e=.5*(1+Math.cos(Math.PI*(this._windowHeightAnimationFrame/this.windowHeightAnimationFrames+1))),s=this._startWindowHeight*(1-e)+window.innerHeight*e;if(this._lastWindowHeight=s,this._rootSelector.style.setProperty("--safe-vh",`${s/100}px`),this._inTableView){let n=window.innerWidth/s>=152/89?1:s/(89*window.innerWidth/152),l=Math.min(n/this.tableViewSlidesPerScreen,1),a=n/l,h=Math.min(Math.max((a-1)/2,this.currentSlide),this.slides.length-1-(a-1)/2),r=window.innerWidth/s>=152/89?`calc(${(8835/89*h-100*h)*l} * var(--safe-vh))`:`calc(${58.125*h*l}vw - ${100*h*l} * var(--safe-vh))`;this.slideContainer.style.transform=`translateY(${r}) scale(${l})`}this._windowHeightAnimationFrame++,this._windowHeightAnimationFrame<=this.windowHeightAnimationFrames&&window.requestAnimationFrame(this._resizeAnimationBound)}nextSlide(i=!1){return new Promise(async(t,e)=>{if(this._currentlyAnimating||this._inTableView){t();return}if(this._currentlyAnimating=!0,this.currentSlide>=0&&!i&&0!==this._numBuilds[this.currentSlide]&&this.buildState!==this._numBuilds[this.currentSlide]){let s=[];this.slides[this.currentSlide].querySelectorAll(`[data-build="${this.buildState}"]`).forEach(i=>{this.fadeUpIn(i,2*this.transitionAnimationTime),s.push(new Promise((i,t)=>setTimeout(i,this.transitionAnimationTime)))});try{s.push(this.callbacks[this.slides[this.currentSlide].id][this.buildState](this.slides[this.currentSlide],!0))}catch(n){}await Promise.all(s),this.buildState++,this._currentlyAnimating=!1;return}if(this.currentSlide===this.slides.length-1){this._currentlyAnimating=!1;return}if(await this.fadeUpOut(this.slideContainer,this.transitionAnimationTime),this.currentSlide>=0&&this.buildState!==this._numBuilds[this.currentSlide]){try{await this.callbacks[this.slides[this.currentSlide].id].reset(this.slides[this.currentSlide],!0,0)}catch(l){}this.slides[this.currentSlide].querySelectorAll("[data-build]").forEach(i=>i.style.opacity=1)}this.currentSlide++,this.buildState=0;try{await this.callbacks[this.slides[this.currentSlide].id].reset(this.slides[this.currentSlide],!0,0)}catch(a){}this.slides[this.currentSlide].querySelectorAll("[data-build]").forEach(i=>i.style.opacity=0),this.slideContainer.style.transform=`translateY(calc(${-100*this.currentSlide} * var(--safe-vh))) scale(1)`,await this.fadeUpIn(this.slideContainer,2*this.transitionAnimationTime),this._currentlyAnimating=!1,t()})}previousSlide(i=!1){return new Promise(async(t,e)=>{if(this._currentlyAnimating||this._inTableView){t();return}if(this._currentlyAnimating=!0,!i&&0!==this._numBuilds[this.currentSlide]&&0!==this.buildState){this.buildState--;let s=[];this.slides[this.currentSlide].querySelectorAll(`[data-build="${this.buildState}"]`).forEach(i=>s.push(this.fadeDownOut(i,this.transitionAnimationTime)));try{s.push(this.callbacks[this.slides[this.currentSlide].id][this.buildState](this.slides[this.currentSlide],!1))}catch(n){}await Promise.all(s),this._currentlyAnimating=!1;return}if(0===this.currentSlide||this.currentSlide===this.slides.length){this._currentlyAnimating=!1;return}if(await this.fadeDownOut(this.slideContainer,this.transitionAnimationTime),this.buildState!==this._numBuilds[this.currentSlide]){try{await this.callbacks[this.slides[this.currentSlide].id].reset(this.slides[this.currentSlide],!1,0)}catch(l){}this.slides[this.currentSlide].querySelectorAll("[data-build]").forEach(i=>i.style.opacity=1)}this.currentSlide--,this.buildState=this._numBuilds[this.currentSlide];try{await this.callbacks[this.slides[this.currentSlide].id].reset(this.slides[this.currentSlide],!1,0)}catch(a){}this.slides[this.currentSlide].querySelectorAll("[data-build]").forEach(i=>i.style.opacity=1),this.slideContainer.style.transform=`translateY(calc(${-100*this.currentSlide} * var(--safe-vh))) scale(1)`,await this.fadeDownIn(this.slideContainer,2*this.transitionAnimationTime),this._currentlyAnimating=!1,t()})}jumpToSlide(i){return new Promise(async(t,e)=>{if(this._currentlyAnimating||this._inTableView){t();return}if(this._currentlyAnimating=!0,i<0||i>=this.slides.length||i===this.currentSlide){this._currentlyAnimating=!1,t();return}let s=i>this.currentSlide;if(s?await this.fadeUpOut(this.slideContainer,this.transitionAnimationTime):await this.fadeDownOut(this.slideContainer,this.transitionAnimationTime),-1!==this.currentSlide&&this.buildState!==this._numBuilds[this.currentSlide]){try{await this.callbacks[this.slides[this.currentSlide].id].reset(this.slides[this.currentSlide],!1,0)}catch(n){}this.slides[this.currentSlide].querySelectorAll("[data-build]").forEach(i=>i.style.opacity=1)}this.currentSlide=i,this.buildState=0;try{await this.callbacks[this.slides[this.currentSlide].id].reset(this.slides[this.currentSlide],!0,0)}catch(l){}this.slides[this.currentSlide].querySelectorAll("[data-build]").forEach(i=>i.style.opacity=0),this.slideContainer.style.transform=`translateY(calc(${-100*this.currentSlide} * var(--safe-vh))) scale(1)`,s?await this.fadeUpIn(this.slideContainer,2*this.transitionAnimationTime):await this.fadeDownIn(this.slideContainer,2*this.transitionAnimationTime),this._currentlyAnimating=!1,t()})}openTableView(i=this.tableViewAnimationTime){return new Promise((t,e)=>{if(this._inTableView||this._currentlyAnimating){t();return}this._currentlyAnimating=!0,this._currentlyTouchDevice&&this.hideShelf(),document.body.style.overflowY="visible",document.body.style.position="relative",this.slideContainer.style.overflowY="visible";let s=document.body.getBoundingClientRect(),n=s.width/s.height>=152/89?1:s.height/(89*s.width/152),l=Math.min(n/this.tableViewSlidesPerScreen,1),a=n/l,h=Math.min(Math.max((a-1)/2,this.currentSlide),this.slides.length-1-(a-1)/2);this.slideContainer.style.transformOrigin=`center calc(${100*this.currentSlide+50} * var(--safe-vh))`;let r=s.width/s.height>=152/89?`calc(${(8835/89*h-100*h)*l} * var(--safe-vh))`:`calc(${58.125*h*l}vw - ${100*h*l} * var(--safe-vh))`;if(this.slideContainer.style.transition=`transform ${i}ms ${this.tableViewEasing}`,this.slideContainer.style.transform=s.width/s.height>=152/89?`translateY(calc(${(this.currentSlide-h)*8835/89*l-100*this.currentSlide} * var(--safe-vh))) scale(${l})`:`translateY(calc(${(this.currentSlide-h)*58.125*l}vw - ${100*this.currentSlide} * var(--safe-vh))) scale(${l})`,this.slides.forEach((t,e)=>{t.parentNode.style.transition=`top ${i}ms ${this.tableViewEasing}`,s.width/s.height>=152/89?t.parentNode.style.top=`calc(${8835/89*(e-this.currentSlide)+100*this.currentSlide+2.5} * var(--safe-vh))`:t.parentNode.style.top=`calc(${58.125*(e-this.currentSlide)}vw + ${100*this.currentSlide} * var(--safe-vh) + (100 * var(--safe-vh) - 55.625vw) / 2)`}),this.buildState!==this._numBuilds[this.currentSlide]){let o=this.slides[this.currentSlide].querySelectorAll("[data-build]"),d=Array(o.length);o.forEach((t,e)=>{d[e]=t.style.transition,t.style.transition=`opacity ${i/2}ms ${this.slideAnimateOutEasing}`,t.style.opacity=1});try{this.callbacks[this.slides[this.currentSlide].id].reset(this.slides[this.currentSlide],!1,i/2)}catch(c){}setTimeout(()=>{o.forEach((i,t)=>i.style.transition=d[t])},i/2)}setTimeout(()=>{let i=this.slides[this.currentSlide].getBoundingClientRect().top;this.slideContainer.style.transition="",this.slides.forEach((i,t)=>{i.parentNode.style.transition="",s.width/s.height>=152/89?i.parentNode.style.top=`calc(${5+8835/89*(t-h)+100*h} * var(--safe-vh))`:i.parentNode.style.top=`calc(${2.5+58.125*(t-h)}vw + ${100*h} * var(--safe-vh))`}),window.innerWidth/window.innerHeight>=152/89?this._bottomMarginElement.style.top=`calc(${5+8835/89*(this.slides.length-h)+100*h} * var(--safe-vh))`:this._bottomMarginElement.style.top=`calc(${2.5+58.125*(this.slides.length-h)}vw + ${100*h} * var(--safe-vh))`,this.slideContainer.style.transformOrigin="center top",this.slideContainer.style.transform=`translateY(${r}) scale(${l})`,document.documentElement.style.overflowY="visible";let e=this.slides[this.currentSlide].getBoundingClientRect().top;window.scrollTo(0,e-i),this._currentlyAnimating=!1,this._inTableView=!0,this._missedResizeAnimation=!1,this.slideContainer.classList.add("lapsa-table-view"),t()},i)})}closeTableView(i,t=this.tableViewAnimationTime){return new Promise((e,s)=>{if(!this._inTableView||this._currentlyAnimating){e();return}this._currentlyAnimating=!0,this.currentSlide=i,this.slideContainer.classList.remove("lapsa-table-view");let n=document.body.getBoundingClientRect(),l=n.width/n.height>=152/89?1:n.height/(89*n.width/152),a=Math.min(l/this.tableViewSlidesPerScreen,1),h=Math.min(Math.max(1.25,this.currentSlide),this.slides.length-2.25),r=this.slides[0].getBoundingClientRect().top;document.documentElement.style.overflowY="hidden",document.body.style.overflowY="hidden",this.slideContainer.style.transformOrigin=`center calc(${100*h+50} * var(--safe-vh))`,this.slides.forEach((i,t)=>{n.width/n.height>=152/89?i.parentNode.style.top=`calc(${8835/89*(t-this.currentSlide)+100*this.currentSlide+2.5} * var(--safe-vh))`:i.parentNode.style.top=`calc(${58.125*(t-this.currentSlide)}vw + ${100*this.currentSlide} * var(--safe-vh) + (100 * var(--safe-vh) - 55.625vw) / 2)`}),this._bottomMarginElement.style.top=0,this.slideContainer.style.transform=`translateY(0) scale(${a})`,window.scrollTo(0,0);let o=this.slides[0].getBoundingClientRect().top,d=r-o;this.slideContainer.style.transform=`translateY(${d}px) scale(${a})`;let c=this.slides[this.currentSlide].querySelectorAll("[data-build]"),u=Array(c.length);c.forEach((i,e)=>{u[e]=i.style.transition,i.style.transition=`opacity ${t/3}ms ${this.slideAnimateInEasing}`,i.style.opacity=0});try{this.callbacks[this.slides[this.currentSlide].id].reset(this.slides[this.currentSlide],!0,t/3)}catch(m){}setTimeout(()=>{c.forEach((i,t)=>i.style.transition=u[t])},t/3),this.slideContainer.style.transition="",this.slideContainer.style.transform=`translateY(${d}px) scale(${a})`,setTimeout(()=>{this.slideContainer.style.transition=`transform ${t}ms ${this.tableViewEasing}`,this.slideContainer.style.transform=`translateY(calc(${-100*this.currentSlide} * var(--safe-vh))) scale(1)`,this.slides.forEach((i,e)=>{i.parentNode.style.transition=`top ${t}ms ${this.tableViewEasing}`,i.parentNode.style.top=window.innerWidth/window.innerHeight>=152/89?`calc(${100*e+2.5} * var(--safe-vh))`:`calc(${100*e} * var(--safe-vh) + (100 * var(--safe-vh) - 55.625vw) / 2)`}),setTimeout(()=>{c.forEach((i,t)=>i.style.transition=u[t]),this.buildState=0,this.slideContainer.style.transition="",this.slides.forEach(i=>i.parentNode.style.transition=""),this._currentlyAnimating=!1,this._inTableView=!1,document.body.style.position="fixed",this._missedResizeAnimation&&(this._startWindowHeight=this._lastWindowHeight,this._windowHeightAnimationFrame=1,window.requestAnimationFrame(this._resizeAnimationBound)),e()},t)},0)})}async showShelf(){!this.permanentShelf&&(this._shelfIsOpen=!0,this._shelfIsAnimating=!0,this._slideShelf.style.display="",this._slideShelf.parentNode.style.paddingRight="100px",this.hideSlideShelfIndicator(this._slideShelfIndicator),await this.showSlideShelf(this._slideShelf),this._shelfIsAnimating=!1)}async hideShelf(){!this.permanentShelf&&(this._shelfIsOpen=!1,this._shelfIsAnimating=!0,this._slideShelf.parentNode.style.paddingRight="0",this.showSlideShelfIndicator(this._slideShelfIndicator),await this.hideSlideShelf(this._slideShelf),this._shelfIsAnimating=!1)}showSlideShelf(i,t=this.shelfAnimationTime){return new Promise((e,s)=>{let n=i.style.transition;i.style.transition=`margin-left ${t}ms ${this.shelfAnimateInEasing}, opacity ${t}ms ${this.shelfAnimateInEasing}`,i.style.marginLeft=`${this._shelfMargin}px`,i.style.opacity=1,setTimeout(()=>{i.style.transition=n,e()},t)})}hideSlideShelf(i,t=this.shelfAnimationTime){return new Promise((e,s)=>{let n=i.style.transition;i.style.transition=`margin-left ${t}ms ${this.shelfAnimateOutEasing}, opacity ${t}ms ${this.shelfAnimateOutEasing}`,i.style.marginLeft=`${-this._shelfMargin}px`,i.style.opacity=0,setTimeout(()=>{i.style.transition=n,e()},t)})}showSlideShelfIndicator(i,t=this.shelfAnimationTime){return new Promise((e,s)=>{if(!this.useShelfIndicator){e();return}let n=i.style.transition;i.style.transition=`opacity ${t}ms ${this.shelfAnimateOutEasing}`,i.style.opacity=1,setTimeout(()=>{i.style.transition=n,e()},t)})}hideSlideShelfIndicator(i,t=this.shelfAnimationTime){return new Promise((e,s)=>{if(!this.useShelfIndicator){e();return}let n=i.style.transition;i.style.transition=`opacity ${t}ms ${this.shelfAnimateInEasing}`,i.style.opacity=0,setTimeout(()=>{i.style.transition=n,e()},t)})}_handleKeydownEvent(i){39===i.keyCode||40===i.keyCode||32===i.keyCode||13===i.keyCode?this.nextSlide():(37===i.keyCode||38===i.keyCode)&&this.previousSlide()}_handleTouchstartEvent(i){this._maxTouches=Math.max(this._maxTouches,i.touches.length),this._currentlyTouchDevice=!0,this._slideShelf.classList.remove("lapsa-hover"),this.slideContainer.classList.remove("lapsa-hover")}_handleTouchendEvent(i){2===this._maxTouches?this.nextSlide():3!==this._maxTouches||this._shelfIsAnimating||(this._shelfIsOpen?this.hideShelf():this.showShelf()),this._maxTouches=0,setTimeout(()=>this._slideShelf.classList.remove("lapsa-hover"),50),setTimeout(()=>this.slideContainer.classList.remove("lapsa-hover"),50)}_handleMousemoveEvent(i){if(this._currentlyTouchDevice){let t=Date.now()-this._lastMousemoveEvent;this._lastMousemoveEvent=Date.now(),t>=3&&t<=50&&33!==t&&(this._currentlyTouchDevice=!1,this._slideShelf.classList.add("lapsa-hover"),this.slideContainer.classList.add("lapsa-hover"))}}fadeUpIn(i,t){return new Promise((e,s)=>{i.style.marginTop=`${this._transitionAnimationDistance}px`,setTimeout(()=>{let s=i.style.transition;i.style.transition=`margin-top ${t}ms ${this.slideAnimateInEasing}, opacity ${t}ms ${this.slideAnimateInEasing}`,i.style.marginTop=0,i.style.opacity=1,setTimeout(()=>{i.style.transition=s,e()},t)},16)})}fadeUpOut(i,t){return new Promise((e,s)=>{let n=i.style.transition;i.style.transition=`margin-top ${t}ms ${this.slideAnimateOutEasing}, opacity ${t}ms ${this.slideAnimateOutEasing}`,i.style.marginTop=`${-this._transitionAnimationDistance}px`,i.style.opacity=0,setTimeout(()=>{i.style.transition=n,e()},t)})}fadeDownIn(i,t){return new Promise((e,s)=>{i.style.marginTop=`${-this._transitionAnimationDistance}px`,setTimeout(()=>{let s=i.style.transition;i.style.transition=`margin-top ${t}ms ${this.slideAnimateInEasing}, opacity ${t}ms ${this.slideAnimateInEasing}`,i.style.marginTop=0,i.style.opacity=1,setTimeout(()=>{i.style.transition=s,e()},t)},16)})}fadeDownOut(i,t){return new Promise((e,s)=>{let n=i.style.transition;i.style.transition=`margin-top ${t}ms ${this.slideAnimateOutEasing}, opacity ${t}ms ${this.slideAnimateOutEasing}`,i.style.marginTop=`${this._transitionAnimationDistance}px`,i.style.opacity=0,setTimeout(()=>{i.style.transition=n,e()},t)})}}